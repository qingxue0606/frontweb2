import $ from"jquery";export default function(Vue){Vue.prototype.$util={config:{apiUrl:"http://192.168.2.103:7099"},formatDate:function(date,format){if(date){switch(format&&"string"==typeof format||(format="yyyy-MM-dd"),typeof date){case"string":date=new Date(date.replace("T"," ").replace(/-/,"/"));break;case"number":date=new Date(date)}if(date instanceof Date){var dict={yyyy:date.getFullYear(),M:date.getMonth()+1,d:date.getDate(),H:date.getHours(),m:date.getMinutes(),s:date.getSeconds(),MM:(""+(date.getMonth()+101)).substr(1),dd:(""+(date.getDate()+100)).substr(1),HH:(""+(date.getHours()+100)).substr(1),mm:(""+(date.getMinutes()+100)).substr(1),ss:(""+(date.getSeconds()+100)).substr(1)};return format.replace(/(yyyy|MM?|dd?|HH?|ss?|mm?)/g,(function(){return dict[arguments[0]]}))}}},ajax:function(opts,urlType){"string"==typeof opts&&(opts={url:opts});var ajaxDefaults={dataType:"json",headers:{token:localStorage.getItem("token")?localStorage.getItem("token"):""},contentType:"application/json",cache:!0,error:function(e){var msg=e.statusText;console.error("请求出错,请联系管理员: \r\n"+opts.url+"\r\n",msg)}};opts.url=urlType?this.setWebUrl(opts.url):this.setWebApi(opts.url),opts=$.extend(ajaxDefaults,opts);try{var uri=this.parseUri(opts.url);void 0!==opts.cros&&!0!==opts.cros||location.host==uri.host||(opts.crossDomain=!0)}catch(e){console.log(e)}$.support.cors||($.support.cors=!0);var xhr=$.ajax(opts);return opts.isabort&&setTimeout((function(){xhr&&xhr.abort()}),opts.timeout||3e4),xhr},get:function(url,data,callBack){return this.ajax({url:url,data:data,type:"get",success:callBack})},post:function(url,data,callBack){return this.ajax({url:url,data:data,type:"post",success:callBack})},setUri:function(url,type){if(null!=type)return this.checkUrl(url)||new RegExp(".*\\.json").test(url)?url:url=(type&&this.config.apiUrl,this.config.apiUrl+url);this.message("msg","缺少type类型,请使用setWebApi/setWebUrl")},setWebApi:function(url){return this.setUri(url,this.config.apiUrl)},setWebUrl:function(url){return this.setUri(url,this.config.apiUrl)},checkUrl:function(url){var RegUrl=new RegExp;return RegUrl.compile("((http|ftp|https)://)(([a-zA-Z0-9._-]+.[a-zA-Z]{2,6})|([0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}))(:[0-9]{1,4})*(/[a-zA-Z0-9&%_./-~-]*)?"),!!RegUrl.test(url)},parseUri(url){for(var o={strictMode:!1,key:["source","protocol","host","userInfo","user","password","authority","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},m=o.parser[o.strictMode?"strict":"loose"].exec(url),uri={},i=14;i--;)uri[o.key[i]]=m[i]||"";return uri[o.q.name]={},uri[o.key[12]].replace(o.q.parser,(function($0,$1,$2){$1&&(uri[o.q.name][$1]=$2)})),uri},clone(obj){var o;if("object"==typeof obj)if(null===obj)o=null;else if(obj instanceof Array){o=[];for(var i=0,len=obj.length;i<len;i++)o.push(_vue.$util.clone(obj[i]))}else for(var j in o={},obj)o[j]=_vue.$util.clone(obj[j]);else o=obj;return o}},Vue.prototype.$eventBus=new Vue}